(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const b of s.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&d(b)}).observe(document,{childList:!0,subtree:!0});function c(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(n){if(n.ep)return;n.ep=!0;const s=c(n);fetch(n.href,s)}})();const g={tablePlayerPlaceholder:document.getElementById("table-player-placeholder"),tableOpponentPlaceholder:document.getElementById("table-opponent-placeholder"),btnRandomize:document.getElementById("btn-randomize"),btnReset:document.getElementById("btn-reset"),btnRotate:document.getElementById("btn-start"),log:document.getElementById("log")},v=(()=>{const f=(e=[],r=!1)=>{let o=document.createElement("tbody");const a=document.createElement("table");return a.appendChild(o),e.forEach((u,m)=>{let L=document.createElement("tr");u.forEach((S,C)=>L.innerHTML+=`<td class="${S.isHit?S.occupant?S.occupant.isSunk()?"sunk":"hit":"mis":""} ${r&&S.occupant?"ship":""}" data-x="${C}" data-y="${m}"></td>`),o.appendChild(L)}),a},l=e=>{e.textContent=""},c=(e,r)=>{l(r),r.appendChild(e)},d=e=>{const r=f(e,!0);c(r,g.tablePlayerPlaceholder)},n=e=>{const r=f(e);c(r,g.tableOpponentPlaceholder)},s=()=>{document.querySelectorAll("td.ship").forEach(r=>{const o=Number(r.dataset.x),a=Number(r.dataset.y);r.classList.add("reserved");for(let u=-1,m=1;u<=1;u++,m--){const L=g.tablePlayerPlaceholder.querySelector(`[data-y="${a}"][data-x="${o+u}"]`),S=g.tablePlayerPlaceholder.querySelector(`[data-y="${a+u}"][data-x="${o}"]`),C=g.tablePlayerPlaceholder.querySelector(`[data-y="${a+u}"][data-x="${o+u}"]`),B=g.tablePlayerPlaceholder.querySelector(`[data-y="${a+m}"][data-x="${o+u}"]`);L&&L.classList.add("reserved"),S&&S.classList.add("reserved"),C&&C.classList.add("reserved"),B&&B.classList.add("reserved")}})},b=()=>{document.querySelectorAll("td.reserved").forEach(e=>e.classList.remove("reserved"))},i=()=>{document.querySelectorAll("td.highlight").forEach(e=>e.classList.remove("highlight"))},h=()=>{document.querySelector(":root").style.setProperty("--clr-highlight","red")},P=()=>{document.querySelector(":root").style.removeProperty("--clr-highlight")},T=(e,r,o,a)=>{i();const u=(m,L)=>{const S=document.querySelector(`[data-x="${m}"][data-y="${L}"]`);S?(S.classList.add("highlight"),P()):h()};if(a==="h")for(let m=0;m<o;m++)u(e+m,r);if(a==="v")for(let m=0;m<o;m++)u(e,r+m)},A=(e,r,o,a)=>{T(e,r,o,a),s()},z=()=>{i(),b()};let k;function y(e,r=0){k&&clearTimeout(k),O();function o(){r<e.length&&(g.log.textContent+=e.charAt(r),r++,k=setTimeout(o,50))}o()}const O=()=>{l(g.log)};function E(){O(),y("Start attacking your opponent 🎯")}return{updateOpponentTable:n,updatePlayerTable:d,logStart:E,logGameOver:(e="")=>{y(`Congrats 🎉. ${e?e.name+" is the winner.":""} click restart button to play again...`)},highlightPlaces:A,removeHighlights:z,logPlace:e=>{y(`There are ${e} ships 🚢 remind. hover on your board to place them.`)},logAttackResult:e=>{if(e.occupant){if(e.occupant.isSunk()){y("Great job. an enemy ship has been sunk ☠️");return}y("You hit a ship tile, keep attacking it 🌊");return}y("missed shot")}}})(),I=f=>{const l=[];return{len:f,hits:l,hit:n=>{l.includes(n)||n>f||n<0||l.push(n)},isSunk:()=>l.length===f}},G=()=>{const l=[5,4,3,3,2];let c=0,d="h",n=Array.from({length:10},t=>Array.from({length:10},e=>({occupant:null,isHit:!1,shipIndex:0})));const s=(t,e,r,o)=>{for(let a=0;a<r;a++)if(o==="v"&&n[e+a][t].occupant||o==="h"&&n[e][t+a].occupant)return!0;return!1},b=(t,e,r,o)=>{if(o==="v"){if(t<0||t>=10||e<0||e+r>10)return!1;for(let a=-1;a<r+1;a++)if(e+a>=0&&e+a<10&&(s(t,e+a,1,"v")||t+1<10&&s(t+1,e+a,1,"v")||t-1>=0&&s(t-1,e+a,1,"v")))return!1}else if(o==="h"){if(t<0||t+r>10||e<0||e>=10)return!1;for(let a=-1;a<r+1;a++)if(t+a>=0&&t+a<10&&(s(t+a,e,1,"h")||e+1<10&&s(t+a,e+1,1,"h")||e-1>=0&&s(t+a,e-1,1,"h")))return!1}return!0},i=(t,e,r,o)=>{if(!b(t,e,r,o))return!1;const a=I(r);if(o==="v")for(let u=0;u<r;u++)n[e+u][t].occupant=a,n[e+u][t].shipIndex=u;else if(o==="h")for(let u=0;u<r;u++)n[e][t+u].occupant=a,n[e][t+u].shipIndex=u;return!0},h=(t,e)=>{const r=n[e][t];return r.isHit===!0?!1:(r.occupant&&r.occupant.hit(r.shipIndex),r.isHit=!0,!0)},P=()=>{d==="h"?d="v":d="h"},T=()=>{l.forEach((t,e)=>{for(;;){const r=["h","v"],o=Math.floor(Math.random()*10),a=Math.floor(Math.random()*10);if(i(o,a,t,r[e%2]))break}})},A=()=>{for(let t=0;t<n.length;t++)for(let e=0;e<n[t].length;e++)if(n[t][e].occupant&&!n[t][e].occupant.isSunk())return!1;return!0},z=()=>{n.forEach((t,e)=>{t.forEach((r,o)=>{n[e][o].occupant=null,n[e][o].isHit=!1,n[e][o].shipIndex=0})})},k=()=>{for(let t=0;t<n.length;t++)for(let e=0;e<n[0].length;e++)if(n[t][e].isHit)return!0;return!1},y=(t,e)=>{c>=E&&(c=0),i(t,e,l[c],d)&&c++},O=()=>{let t=0;for(let e=0;e<n.length;e++)for(let r=0;r<n[0].length;r++)n[e][r].occupant&&n[e][r].shipIndex===0&&t++;return t},E=()=>l.length;return{placeShip:i,board:n,receiveAttack:h,placeShipsRandomly:T,areAllShipsSunk:A,hasReceivedAttack:k,resetBoard:z,toggleDirection:P,placeNextShip:y,isFull:()=>O()===E(),remindShipsCount:()=>l.length-O(),nextShipLength:()=>l[c],nextShipDirection:()=>d}},N=f=>{const l=new Set;function c(i=10){return[Math.floor(Math.random()*i),Math.floor(Math.random()*i)]}function d([i,h]){return l.has(`${i}-${h}`)}function n(i){let h=c(i.length);for(;d(h);)h=c(i.lengt);return h}function s(i,h,P){return i.receiveAttack(h,P)}function b(i){if(l.size===i.board.length*i.board.length)return;const h=n(i.board);i.receiveAttack(...h),l.add(`${h[0]}-${h[1]}`)}return{name:f,attack:s,randomAttack:b}},p=(()=>{let f,l,c,d;const n=()=>{f=N("you"),l=N("opponent"),c=G(),d=G()},s=()=>i()&&(c.areAllShipsSunk()||d.areAllShipsSunk()),b=()=>c.areAllShipsSunk()?l:d.areAllShipsSunk()?f:null,i=()=>c.hasReceivedAttack()||d.hasReceivedAttack();return{init:n,isOver:s,winner:b,isStarted:i,isReadyToStart:()=>c.isFull()&&d.isFull()&&!i(),getPlayerBoard:()=>c.board,getOpponentBoard:()=>d.board,getPlayerGameboard:()=>c,getOpponentGameboard:()=>d,player:()=>f,opponent:()=>l}})();function H(){let f,l,c,d,n,s;function b(){f=p.getOpponentGameboard(),l=p.getPlayerGameboard(),c=p.getPlayerBoard(),d=p.getOpponentBoard(),s=p.player(),n=p.opponent()}function i(){v.updatePlayerTable(c)}function h(){v.updateOpponentTable(d)}function P(){h(),i()}function T(t){if(p.isOver()||!p.isReadyToStart()&&!p.isStarted())return;const e=t.target;if(e.localName!=="td")return;const r=Number(e.dataset.x),o=Number(e.dataset.y);s.attack(f,r,o)&&(A(),z(),P(),R(d[o][r]))}function A(){if(p.isOver()){h(),R();return}}function z(){n.randomAttack(l),p.isOver()&&(i(),v.logGameOver(p.winner()))}function k(){p.init(),b(),f.placeShipsRandomly(),P(),R()}function y(){p.isStarted()||(l.resetBoard(),l.placeShipsRandomly(),i())}function O(t){if(l.isFull())return;const e=t.target,r=Number(e.dataset.x),o=Number(e.dataset.y);v.highlightPlaces(r,o,l.nextShipLength(),l.nextShipDirection())}function E(t){if(l.isFull())return;const e=t.target,r=Number(e.dataset.x),o=Number(e.dataset.y);l.placeNextShip(r,o),i(),R()}function R(t=null){p.isReadyToStart()||v.logPlace(l.remindShipsCount()),p.isReadyToStart()&&v.logStart(),p.isStarted()&&t&&v.logAttackResult(t),p.isOver()&&v.logGameOver(p.winner())}function $(){l.toggleDirection()}document.addEventListener("DOMContentLoaded",k),g.tableOpponentPlaceholder.addEventListener("click",T),g.btnReset.addEventListener("click",k),g.btnRandomize.addEventListener("click",y),g.tablePlayerPlaceholder.addEventListener("mouseover",O),g.tablePlayerPlaceholder.addEventListener("mouseleave",v.removeHighlights),g.tablePlayerPlaceholder.addEventListener("click",E),g.btnRotate.addEventListener("click",$)}H();
